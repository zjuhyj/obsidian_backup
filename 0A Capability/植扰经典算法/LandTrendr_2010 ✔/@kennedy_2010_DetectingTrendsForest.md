---
NO: M006
title: "Detecting trends in forest disturbance and recovery using yearly Landsat time series: 1. LandTrendr — Temporal segmentation algorithms"
authors: Robert E. Kennedy, Zhiqiang Yang, Warren B. Cohen
year: 2010
journal: 
DOI: 10.1016/j.rse.2010.07.008
---
<font size="5"><strong>标题</strong>：<strong>Detecting trends in forest disturbance and recovery using yearly Landsat time series: 1. LandTrendr — Temporal segmentation algorithms</strong></font>
<font size="5">利用每年的Landsat时间序列检测<span style="color:red;"><strong>森林干扰和恢复</strong></span>的趋势：1 . <strong>LandTrendr ——时态分割算法</strong></font>
- 关键词：
	- Change detection 变化检测
	- Land cover dynamics 土地覆盖动态变化
	- Landsat Time series Landsat时间序列
	- Forest disturbance 森林扰动
	- Forest growth 森林生长
	- Temporal segmentation 时间分割
- 主要内容：
![[Pasted image 20250224091140.png]]

---
## 1 方法概述

- LST的两个主题：
	- **短期事件的捕获**与**长期趋势的平滑**
- LandTrendr：
	- 名称：Landsat-based Detection of Trends in Disturbance and Recovery 基于Landsat的扰动与恢复趋势检测
	- 目标：捕获趋势和事件
	- 基本认识：
		- 变化并非仅仅是两个时间点之间的简单对比，而是在景观上以**快速和慢速两种速度运行的连续过程**。
		- 不需要预先确定的变化模型——数据本身就决定了变化轨迹的形状
	- 挑战：
		- 在消除由光照、物候、大气条件及几何配准引起的瞬时变化噪声的同时，解析时间序列中的显著特征。
- LandTrendr实现：
	- 三大策略：
		1.  追踪跨年度的持久性覆盖变化  
			- 追踪多年间持续存在的覆盖状况变化，而非捕捉年内趋势
			- 由于云层覆盖、数据采集的间断性以及Landsat卫星16天的重访周期，认为**年际时间尺度**是大多数Landsat档案数据最适合的时间分辨率➡认为年际变化属于噪声
		2. 采用纯像素级分析结构  
			- 转向完全基于像素的分析结构。虽然每年可以输入多张图像，但每个像素的时间轨迹是基于每年为每个像素选择的最佳单一值构建的。
			- 此方法可以在像素级别上避免云层、云影以及由Landsat 7扫描线校正器故障造成的数据空白
		3. 结合平滑与非平滑的光谱变化捕捉  [[平滑处理&非平滑处理]]
			- 既允许对长期信号中的光谱噪声进行时间平滑处理，也允许对突发性事件的光谱变化进行非平滑捕捉。
			- 该方法<u>既能捕捉缓慢演变的过程（例如重新生长），也能识别突发性事件（如森林采伐）</u>
	- <mark class="highlight">主要步骤</mark>：
		1. 通过相对辐射定标和简单的云层筛选规则，每年从多个图像中创建即时镶嵌图，并以**像素**为单位提取光谱数据的时间轨迹
		2. 应用基于时间的**时间序列分割策略**，对光谱指数进行回归和点对点拟合。
		
	- 优化：
		- 考虑到任何时间轨迹模式都是可能的，LandTrendr使用控制参数和基于阈值的过滤来减少误报检测。
	- 评估数据：
		- 由于缺乏用于评估控制参数和模型整体性能的参考数据，研究团队开发了一种<u>基于相同概念框架的伴随解释方法</u>，适用于捕捉长短期过程。
			- 开发了软件工具<span style="color:red;"><strong>TimeSync</strong></span>，用于光谱轨迹的专家解释和分割
				- 与Landsat时空分辨率相匹配，且能够捕捉大面积区域中所有感兴趣的现象（包括突发性事件和长期过程）
				- 区分突发性和长期过程
			- 为LandTrendr的检验提供真实数据集
	- 检验：
		- 应用：在美国俄勒冈州和华盛顿州西部的数百个随机点进行了测试
			- 森林类型多样
		- 性能评估：鉴于LTS数据可能产生的多样化输出结果，研究团队针对干扰、恢复和稳定性的总结指标评估了算法性能。这些指标既适用于短期事件的捕捉，也适用于长期过程的分析。

## 2 算法步骤

### 2.1 预处理

（1）图像选择

- 季节一致性优于无云作为最高优先级
- 每年摄取多张部分有云的图像来创建年度“即时”拼接图从而达到最少云量。
	- 即使对于一年中所有图像都恰好被云覆盖的那些剩余像素，也经常可以在年度时间序列的前后的图像中找到没有被云覆盖的对应像素，仍然可以拟合光谱轨迹。

（2）几何校正

- United States Geological Survey 美国地质调查局（USGS）在*__2008年__*开放Landsat数据档案，使用户能够免费获取Landsat卫星的数据。开放档案之后获取的Landsat图像通常具有**sub-pixel geolocation accuracies 亚像素级别**的地理定位精度，因此不需要进一步的几何处理
	- *亚像素级别：图像中的地理位置误差小于一个像素的大小*
	- 有些Landsat需要几何校正，有些不需要
- 对于档案开放前的LST，研究团队依赖<u>多个不同的数据源</u>构建LST，并在需要几何校正时，使用自动连接点选择算法为每张图像找到200到500个不等的控制点进行正射校正

（3）辐射归一化&变化

1. 大气校正：cosine–Theta（COST）
	- 目的：去除长期序列（LTS）中单个参考图像的大部分大气效应。
	- 选择暗目标值：通过训练有素的解释员按照Kennedy等人（2007a）协议中规定的规则进行视觉评估，确定用于COST计算的暗目标值

2. 图像归一化：multivariate alteration detection and calibration （MADCAL）
	- 目的：将同一场景的所有剩余图像<u>归一化到经过COST校正的参考图像上</u>
	- 在较大图像的一个小子集中识别稳定的像素，并利用这些稳定像素进行归一化处理
	- **异常情况**
		- 原因：部分子集中包含云覆盖的像素，不符合MADCAL算法的基本假设，以至于被错误地纳入了“无变化”（nochange）群体，导致校正结果不准确
		- 识别方法：
			- 波段散点图（band-wise scatterplots）：显示不同波段之间的关系，有助于识别异常值或异常模式。
			- 堆栈摘要统计数据（stack-wise summary statistics）：提供整个图像堆栈的统计信息，帮助发现异常现象。
	- 该方法并不严格要求所有图像都是无云的，而是只要求图像中的某些子集是无云的。*这意味着即使图像中有部分区域有云，只要选择的子集是清晰的，仍可应用MADCAL进行有效的辐射归一化和变换。*

（4）<mark class="highlight">Tasseled-cap transformation 缨帽变换 </mark>


- 即  Kauth-Thomas Transformation，K-T变换。早期多用K-T称呼，现多用Tasseled-cap。
- 归一化过程使得不同传感器之间的**光谱空间相对一致**，因此对长期序列（LTS）中的所有图像使用相同的光谱变换是**必要**的 #困惑 
	- *目的：简化多波段遥感数据的分析，并增强某些特定的地物特征*
	- 使用了由Crist定义的适用于反射率的系数进行缨帽变换
	- 无论使用哪种Landsat传感器（如Landsat 5、7或8），都使用同一套系数进行变换，确保了在整个时间序列（LTS）中的一致性


（5）云、烟雾、雪和阴影屏蔽

- 策略：
	1. 对比时间序列中的目标图像和参考图像，利用特定的分数来突出目标效应（如云、雪、烟雾和阴影）
		- *使用Tasseled Cap Brightness和Wetness构建云/阴影分数*
	2. 解释人员手动确定每张图像的云得分和阴影得分的阈值
	3. 应用手动设定的阈值生成二值化的云/雪/烟雾和阴影掩膜，并通过3×3中值滤波器进行空间过滤以扩展掩膜区域

### 2.2 影像堆栈镶嵌&轨迹提取

- *在遥感和图像处理领域，"stack"（堆栈）通常指的是一组按特定顺序排列的图像或其他数据层。*
- 一旦在时间序列分析（TSA）中的图像被标准化，并创建了云遮罩图像，图像堆栈就被组织起来以进行轨迹分割步骤
	1. 影像镶嵌：对于有多个图像可用的年份，生成无缝拼接的图像
		- 对于每个像素，选择其光谱值来自整个堆栈中最接近中位数儒略日（Julian Day）的图像
		- 如果目标日期的像素被云覆盖，则从日期上接下来最近的图像中选取该像素的光谱值
	2. 轨迹提取：在像素尺度上提取光谱轨迹，并传递给轨迹分割算法
		- 使用3x3窗口内的平均值作为该像素的光谱值，以平衡空间细节和鲁棒性

### 2.3 轨迹分割

- 时间分割： 将一个像素的光谱时间序列建模为**一系列直线段**，以此来捕捉轨迹的主要特征，消除噪声同时不牺牲必要的细节
	- 捕捉Landsat时间序列中突发和缓慢现象的核心方法
- <mark class="highlight">LandTrendr轨迹分割全过程</mark>：
	- Fig. 3. LandTrendr分割过程
	- ![[Pasted image 20250224194224.png]]

---
（1） **移除峰值**

- 假设：由噪声引起的峰值（如残留的云、雪、烟雾或阴影）是短暂的，光谱指数在峰值后的年份会返回到峰值前的值，而真实的地表覆盖变化则更为持久
- 仅移除前后光谱值相似的峰值，相似度的程度由一个控制参数`despike`设定
- 过程迭代，每次迭代只修正最严重的峰值，直至没有任何峰值超过设定的`despike`参数

---

（2）**识别潜在顶点**

- 时间序列中的顶点是[年份, 光谱值]组合
- 采用两种互补策略：
1. **基于回归的顶点识别**：使用残差项标识
	1. 起始顶点：将整个时间序列的第一年和最后一年定义为初始顶点
	2. 一阶最小二乘回归，计算残差项➡识别新顶点
		1. 对<span style="color:red;"><strong>时间序列中的所有点</strong></span>计算光谱指数与年份之间的一阶最小二乘回归线
		2. 计算每个点相对于回归线的残差误差（Residuals，即实际值与回归线预测值之间的差异），选择具有最大绝对偏差的点作为下一个顶点
			- 这个顶点代表了一个显著的变化点，可能指示了一个重要的地物变化事件
		3. 该顶点将时间序列划分为两个分段：从第一年到该顶点的一个段，以及从该顶点到最后一年的另一个段。
	3. 拟合新分段，计算均方误差➡确认下一个分割分段
		1. 对每个新生成的段分别计算新的回归线，计算每个段的均方误差（MSE），用于衡量回归线与实际数据点之间的拟合程度。
			- 较大的MSE表示该段内的数据点偏离回归线较多，表明可能存在更多的变化或噪声。
		2. 选择**较大MSE的分段**进行进一步分割（<u>重复步骤2</u>），以识别更多的顶点
	4. 迭代分割
		- 重复上述过程，直到段数量达到由`max_segments`和`vertexcount overshoot`控制参数之和设定的数量，从而确保了模型既不过度复杂化，又能捕捉到主要的变化特征。
			- 基于回归的方法可能会检测出比预期更多的顶点（即超过 `max_segments + 1` 个顶点）。`vertexcountovershoot` 参数定义了这种超限的具体数值

2. **削减过多段落**

- 使用角度标准提出多余的线段
- 线段：在[年份, 光谱值]空间中，通过连接顶点的实际值（而不是回归拟合值）来计算段落
- 为了使单一的角度准则在具有不同绝对值的<u>光谱指数之间</u>有意义，**缩放光谱值**以使<u>年份和光谱值的范围</u>相等
	- 如果光谱值范围不同，会影响角度计算的大小
- **步骤**：
	1. 具有最小角度的顶点被移除，从而消除一个段落
	2. 在被移除顶点的两个相邻顶点之间重新绘制一个新的段落，然后重新计算所有顶点的角度
	3. 重复进行削减过程，直到段落数量达到`max_segments`设定的数量

---

（3） **拟合轨迹**

- 一旦确定了最终的<span style="color:red;"><strong>候选顶点集合</strong></span>，使用第二组拟合算法来确定每个顶点年份的光谱值，以生成整个时间序列的最佳连续轨迹
	- 概念上，在（2）中侧重识别时序中X轴的断点（中断年份），而（3）中轨迹拟合算法则是根据X轴顶点对Y轴（光谱值）进行打磨

- 算法要求：**平滑趋势上的噪声**&**捕捉突然的变化**而非平滑——不一致的目标
- **步骤**：从早到晚进行**点对点** or **基于回归**的拟合
	- 第一个分段：点到点or回归使该段落的均方误差（MSE）更低就采取那种
	- 后续分段：区段开始年份的位置需<u>与前一个分段连接</u>
		- 点对点：直接连接到下一个顶点的实际点
		- 基于回归：以起始点为锚点的简单回归进行平滑处理
	- 分段较好地连接了上一分段选择的顶点

- 拟合优度指标： #困惑  #先跳过，不全
	- 计算了**标准F统计量的p值**，用于评估该模型在整个轨迹上的拟合效果
		- 此处的p值不能作为严格意义上的拟合优度检验，非真实度量
			- 没有先验模型被测试
			- 没有考虑时间自相关的影响
		- 调整了 顶点到顶点 的分段的自由度，以避免p值被错误降低
		- 提供了具有<u> 不同分段数量（预测变量）</u>的**分段模型**之间的比较：实验发现，<u>其提供与 Akaike information criterion（AIC）和一种抗自相关度量方法相同的相对信息，但计算速度显著更快</u>
			- *AIC信息准则是衡量统计模型拟合优良性的一种标准，建立在熵的概念基础上，可以权衡所估计模型的复杂度和此模型拟合数据的优良性*

---
（4） **简化模型**

- 迭代简化并重新拟合轨迹，使用的分段数量逐渐减少，从而得到从最大分段数到1的各个分段数对应的轨迹模型
	1. **分段简化**
		- <u>移除最弱的顶点</u>来完成的，根据**恢复速率准则**或**均方误差**（MSE）准则定义
		- 恢复速率准则（控制参数为`recovery_threshold`）
			- 如果某个分段的光谱值能在`1/recovery_threshold`年内<u>覆盖整个轨迹的光谱范围（即从最小到最大的光谱值）</u>，则该分段会被移除。
				- 如当 `recovery_threshold = 1`时，如果某个分段的光谱恢复速率能使光谱在1年内使光谱值从最小变到最大，则这个分段会被移除。
			- 反映了这样一个事实，即许多生态系统的极快恢复更有可能是**由于阴影或云掩蔽**造成的，而不是由于地面上不切实际的稳健条件造成的
	2. **重新拟合轨迹**：每进行一次简化，重复轨迹拟合步骤，更新相应的拟合统计数据
- 由于具有更多段的模型具有更大的自由度，因此更简单的模型可能比更复杂的模型具有更高的拟合分数。
	- *自由度：模型在拟合数据时可以调整的参数数量*

---

（5）**确定最佳模型**

- 使用 <span style="color:red;"><strong>F统计量的p值（p-of-f）</strong></span>  确定最佳模型  #困惑  #先跳过，不全
- 最佳模型中，每个段的类型（干扰或恢复）、顶点年份和顶点值构成了 LandTrendr 分割算法的核心输出
	- 这些输出会与一个独立的数据集进行对比评估，将这些输出称为“第一阶段”，以区别于下一节中描述的经过过滤后的输出

---

（6）<mark class="highlight"><strong>按植物覆盖度的变化进行过滤</strong></mark>

- **目的**：使用变化幅度阈值**过滤**原始分割算法中捕获的微小光谱变化
	- *确保检测到的变化是真实且有意义的，而不是由于噪声或其他非实质性因素引起的*
	- <mark class="highlight-blue">【我的理解】</mark>：确保过滤噪声的阈值有意义
- 由于<u>光谱指数本身无物理意义</u>，因此根据估计的植物覆盖变化百分比进行过滤
- 采用两种模型方法：将光谱数据与这些解释值关联起来，以<span style="color:red;"><strong>估算植被覆盖百分比的变化</strong></span>
	1. 静态模型
		- 在光谱值和覆盖率百分比估计值之间进行回归
		- 使用该静态模型计算每次变化前后的覆盖率百分比，最后减去得到的覆盖率估计值来计算植被覆盖率变化
	2. 增量模型
		- 直接对覆盖变化进行建模
		1. 使用重抽样随机配对不同的图斑（plots），对于每一对图斑，分别计算它们的植被覆盖百分比差异和光谱值差异
		2. 建立回归模型模拟植被覆盖百分比差异与光谱值差异之间的关系
	- 对于这两种模型，使用三种不同的光谱指数：穗帽湿度（witness）、归一化燃烧比 （NBR） 、归一化差值植被指数 （NDVI）
		![[Pasted image 20250225202832.png]]
- 每个分段的**植被覆盖变化百分比**随后与控制参数（表1）进行比较，以确定该分段的变化是否值得保留
	- *当变化低于阈值时认为是噪声，不予保留*
	- 短期趋势（1年）：1年内的变化更容易受到瞬时噪声的影响，需要更高的阈值`pct_veg_loss1`来标记。
	- 长期趋势（20年）：在20年内显示出一致趋势的变化，其不太可能由噪声引起，因此可以使用较低的阈值`pct_veg_loss20`来标记这些变化。
	- 中间持续趋势（1~20年间）：其阈值通过简单线性插值法在1年和20年的阈值之间进行计算
	- 稳健分段：分段的光谱指数变化值小于用户定义的参数
- 将经过植被覆盖百分比过滤后的<u>分段结果</u>称为“第二阶段”结果


---

- **参数表**
![[Pasted image 20250225091707.png]]

## 3 算法评估

//


---

# 重要摘录

- 两次成像的变更检测方法未能充分挖掘众多多时相图像之间的相互关系，并且可能无法从背景噪声中区分出在气候变化下预期出现的微小或长期的植被覆盖状况和活力变化
- 因此，多年来，以提高变化检测中的**信噪比**为目标开发了多种图像

---
# 补充说明


