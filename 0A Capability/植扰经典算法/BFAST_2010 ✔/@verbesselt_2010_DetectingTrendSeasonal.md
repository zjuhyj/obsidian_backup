---
NO: M007
title: Detecting trend and seasonal changes in satellite image time series
authors: Jan Verbesselt, Rob Hyndman, Glenn Newnham, Darius Culvenor
year: 2010
journal: 
DOI: 10.1016/j.rse.2009.08.014
---

<font size="5"><strong>标题</strong>：<strong>Detecting trend and seasonal changes in satellite image time series</strong></font>
<font size="5">检测卫星图像时间序列中的<span style="color:red;"><strong>趋势和季节性变化</strong></span></font>

- 关键词：
	- 
- 主要内容：



![[Pasted image 20250303134748.png]]



## 1 方法概述



- **BFAST**(Breaks For Additive Seasonal and Trend)：基于检测并表征附加的季节性断点和趋势断点的时间序列通用变化检测方法
	- 将时间序列迭代分解为**趋势、季节性和剩余成分**，并结合变化检测方法**识别断点**
	- 优点：无需对土地覆盖类型进行归一化处理，<u>无需选择参考周期、设置阈值 or 定义变化轨迹</u>；不针对特定数据类型，可直接应用于时间序列数据
	- <span style="color:red;"><strong>主要目标</strong></span>
		1. **季节成分和趋势成分**：检测多个<span style="color:red;"><strong>断点（突然变化）</strong></span> #混淆点
			- 由<span style="color:red;"><strong>干扰</strong></span>引起的突变，如火灾、**昆虫**等
			- ▲ 干扰既会影响季节成分，也会影响趋势成分
		2. 趋势成分：通过推导其变化时间、幅度和方向，来表征**渐进变化**&**断点**
- **需要理清**：生态系统中的三种变化与季节成分、趋势成分之间的关系，详看[[#3 重要摘录|3 重要摘录]]
## 2 算法步骤
- 传统的分解技术（见3 重要摘录）：其平滑处理的方式**无法有效**识别时间序列中的**突然变化或断点**➡BFAST：同时也能有效地识别突然的变化/断点
- BFAST：
	- 将时间序列的**迭代分解**集成到趋势、季节性和噪声分量中
	- 检测&表征时间序列内**变化**（即**断点**）

---

（1）**分解模型概述**

- 加法（addive）分解模型：$Y_t=T_t+S_t+e_t, t = 1, ..., n$
	- $Y_t$：观察到的数据；
	- $T_t$：趋势分量；$S_t$：季节分量；$e_t$：剩余分量

（1）趋势分量$T_t$

- 定义：**长期、缓慢、非周期性趋势**，如**年平均降水量的变化**
- 假设 $T_t$ 是分段线性的
	- 假设趋势分量<mark class="highlight">断点</mark>为： $t_1^\ast,..., t_m^\ast$ 
		- $t_0^\ast=0$
		- $m$：趋势分量共几个断点
	- $T_t$ 的分段线性模型为：$$T_t = \alpha_j +  \beta_jt$$
		-  $t_{j-1}^*<t\leq t_{j}^*, t = t_{j-1}^*+1,...,t_{j}^*, j = 1, ..., m$
		- $j$：趋势分量中的第几个断点
		- 截距 $\alpha_j$​：表示在第 $j$ 个区间内，趋势成分的起始值
		- 斜率 $\beta_j$：表示在第 $j$ 个区间内，趋势成分随时间的变化率

- <span style="color:red;"><strong>断点</strong></span>和<span style="color:red;"><strong>渐进变化</strong></span>的表征：
	- 突变的幅度：在**断点** $t_j^∗​$处可以用截距$\alpha_j$和斜率$\beta_j$表示：
		- $Magnitude = (\alpha_{j-1}- \alpha_j)+ (\beta_{j-1}- \beta_j)t$
	- 渐变的斜率：在**断点**$t_j^∗​$ 处，渐变的斜率由相邻两个区间的斜率决定
		- <u>断点前</u>：$\beta_{j-1}$
		- <u>断点前</u>：$\beta_j$

（2）季节分量$S_t$

- 定义：具有**严格周期性**，如**物候**
- <span style="color:red;"><strong>季节性成分固定在断点之间，但在跨断点时可能会发生改变</strong></span>
	- <span style="color:red;">同一季节位置（如“1月”）在断点区间内的效应相同（固定），但不同季节位置的效应不同</span> #混淆点 
	- **固定**：在一个确定的时间段内（两个断点之间的时期），季节成分被认为是稳定的周期性行为或模式
	- **改变**：但当达下一个时间段（即下一个断点之后），这种季节模式可能会发生变化
	- **断点**：时间轴上的关键点，标志着季节性模式可能发生变化的时刻。

- <u>季节分量中的断点与趋势分量中的断点可能不同</u>
<br>

- 假设季节分量<mark class="highlight">断点</mark>为：$t_1^\#,..., t_p^\#$
	- $p$：季节分量共几个断点
	- *季节性分量在时间序列中发生显著变化的时间点*

- 季节分量$S_t$可以表示为，其中$t_{j-1}^\#<t\leq t_{j}^\#, t = t_{j-1}^\#+1,...,t_{j}^\#, j = 1, ..., p$：

	- <div style="text-align: center">
		<img src="Pasted image 20250310162310.png" alt="描述文字" width="500"/>
		</div>
		
		- <mark class="highlight">注意</mark>：这里的$i \neq 0$
		- $s$：**季节性的时期数量**，<u>即一个完整季节<strong>周期</strong>内的数据点数量</u> #混淆点 
			- 周期：重复出现的**时间间隔**
			- <mark class="highlight-blue">理解</mark>：和STL中的$n_p$**在定义上完全相同**，均表示<span style="color:red;"><strong>时间序列的季节性周期长度，即一个完整季节周期内的数据点数量</strong></span>。但两者侧重点不同：
				- STL：$s$决定季节子序列的分组规则（如所有1月数据平滑后生成季节成分）。
				- BFAST：$s$影响季节断点的检测范围（如突变点是否在周期内对齐）。
			- 如：对于16天的MODIS NDVI数据， $s=23$（一年约23个观测点）
		- $\gamma_{i,j}$：季节 $i$ 的影响，即**季节效应**，是一个具体的**值** #混淆点 
			- <mark class="highlight-blue">理解</mark>
				- <u>季节分量在断点之间固定</u>：$i$表示所处的季节，即断点区间内同一季节位置的季节效应相同，不同位置的不同
				- <u>在跨断点时发生改变</u>：所以下标有$j$
			- <mark class="highlight-blue">理解</mark>：<span style="color:red;">断点区间的长度可能跨越多个完整的季节周期，也可能包含不完整周期</span>，但断点区间内所有观测点的季节分量$\gamma_{i,j}$是固定的 #混淆点 
				- 同一季节位置（如“1月”）在断点区间内的效应相同，但不同季节位置的效应不同
		- ![[Pasted image 20250312095153.png]]
- <span style="color:red;"><strong>季节周期内，即s个连续时序的季节效应之和为0</strong></span>，避免季节性周期中间发生的季节性中断影响趋势变化 #混淆点  
	- $$\sum_{i=0}^{s-1}\gamma_{i,j}=0$$
	- ➡ 可以重写为：
		- $$S_t=  \sum_{i=1}^{s-1} \gamma_{i,j}(d_{t,i}-d_{t,0})$$

			- $d_{t,i}​$：<span style="color:red;"><strong>季节虚拟变量</strong></span>（Seasonal Dummy Variable）：表示时间 $t$ 是否处于第 $i$ 个季节 #混淆点 
				
				- 当 $t$ 在季节 $i \neq 0$ 时： $d_{t,i} = 1$ ， $d_{t,0​}=0$ 且 $d_{t,k}​=0$（对于 $k  \neq i$）
			- $d_{t,0}​$​ ：基准季节（season 0）的季节虚拟变量
				- 当 $t$ 在季节 $0$ 时：$d_{t,0​}=1$ 且所有 $d_{t,i} = 0$（对于 $i  \neq 0$）
			- 当 $t$ 在季节 $0$ 时，$d_{t,i}-d_{t,0} = -1$
			- 当 $t$ 在季节$i$时，$d_{t,i}-d_{t,0} = 1$ ，$d_{t,k}-d_{t,0} = 0$ （对于 $k \neq i$）
	- ➡ 可以解释为：一个没有截距项但包含$s-1$个季节虚拟变量的模型


（3）剩余分量$e_t$

- 时序减去趋势分量$T_t$和季节分量$S_t$

---

（2）**迭代计算过程**
- 步骤
	-  初始化：STL方法估计季节性分量($\widehat{S}_t$)
		- 使用Seasonal-Trend decomposition procedure（**STL**）方法初始季节成分 $\widehat{S}_t$ [[@补充_STL方法]] 
			- <mark class="highlight-blue">注意</mark>：好好看看STL方法，非常有助于理解季节分量$\widehat{S}_t$！！！！
			- STL中：对各<u>季节性子序列</u>进行LOESS平滑，而后将**平滑均值**拼接成$\widehat{S}_t$，迭代优化
	1. 检测趋势断点（基于去季节数据$Y_t-\widehat{S}_t$）
		- 输入数据：$Y_t-\widehat{S}_t$
		- 检测方法：
			- **OLS-MOSUM**检验：通过滑动窗口计算残差累积和，检测突变点（P < 0.05时拒绝无断点假设） [[@补充_OLS-MOSUM检验]]
			- 断点估计：若检验显著，用Bai-Perron方法确定断点**数量和位置**（$t_1^\ast,..., t_m^\ast$）[[@补充_Bai-Perron方法]]
		- 输出：趋势断点位置，分段线性趋势模型
	2. 拟合分段趋势模型（M估计）[[@补充_M估计（稳健回归）]]
		- 趋势模型：$T_t = \alpha_j +  \beta_jt$（$j=1,..., m$，对于$t = t_{j-1}^*+1,...,t_{j}^*$）
		- 拟合方法：**M估计（稳健回归）**，通过Huber损失函数减少异常值影响
		- 输出：
			- 趋势分量系数：$\alpha_j$，$\beta_j$
			- 趋势分量估计值：$\widehat{T}_t = \widehat{\alpha}_j +  \widehat{\beta}_jt$（$t = t_{j-1}^*+1,...,t_{j}^*$）
	3. 检测季节性断点（基于去趋势数据$Y_t-\widehat{T}_t$）
		- 输入数据：$Y_t-\widehat{T}_t$
		- 检测方法：
			- 同样使用**MOSUM检验**判断季节性突变
			- 若显著，，用Bai-Perron方法确定断点位置（$t_1^\#,..., t_m^\#$），并通过BIC最小化选择断点数量
		- 输出：季节断点位置，季节模型
		
	4.  拟合分段季节模型（M估计）
		- 趋势模型：$S_t=  \sum_{i=1}^{s-1} \gamma_{i,j}(d_{t,i}-d_{t,0})$（$j=1,..., p$，对于$t = t_{j-1}^\#+1,...,t_{j}^\#$）
		- 拟合方法：**M估计（稳健回归）**，通过Huber损失函数减少异常值影响
		- 输出：
			- 季节分量系数：$\gamma_{i,j}$（$i=1,..., s-1$）
			- 季节分量估计值：$\widehat{S}_t=  \sum_{i=1}^{s-1} \widehat{\gamma}_{i,j}(d_{t,i}-d_{t,0})$（$t = t_{j-1}^\#+1,...,t_{j}^\#$）
	- 重复上述步骤，**迭代至断点的数量和位置保持不变**

<br>

- 断点间的数据比例：MODIS 16天时间间隔，需要至少一年的时序才可检测出断点，即如果在一年内发生两次变化，则只会检测到最显著的变化

---





## 3 示例图
![[Pasted image 20250312091823.png]]
![[Pasted image 20250312091831.png]]


- 趋势成分中的变化检测
	- ![[Pasted image 20250312101449.png]]
	- ![[Pasted image 20250312101502.png]]
- 
## 4 重要摘录

- 标准的时间序列分解方法假设趋势和季节性成分是平滑且缓慢变化的，因此这些方法并不直接适用于识别变化的问题。
	- 例如，**Seasonal-Trend decomposition procedure （STL）**基于局部加权回归平滑器（LOESS）将一个序列分解为趋势、季节性和剩余成分。但是<u>这种平滑处理阻碍了对时间序列内部变化的检测</u>。
- 时序中，通过分别检测**趋势成分**和**季节成分**中的变化（断点），可以更精确地分类<u>不同类型的变化</u>

---

- 生态系统变化分类： #⭐
	1. 季节变化（**seasonal change**）/▲ 季节成分（**seasonal component**）
		- ▲ 定义：具有**严格周期性**，如**物候**
		- **由**年度温度和降雨量的交互作用**驱动**，影响植物的物候周期（如发芽、开花、落叶等）或不同植被类型的覆盖比例
	2. 渐进变化（**gradual change**）/ ▲ 趋势成分（**trend component**）
		- ▲ 定义：**长期、缓慢、非周期性趋势**，如**年平均降水量的变化**
		- 如年际气候变化（如年平均降雨量的趋势）或土地管理、土地退化的逐渐变化
	3. 突然变化（**abrupt change**） 
		- ▲ <mark class="highlight">结构性断点，两种成分中均存在</mark>
		- 由<span style="color:red;"><strong>干扰</strong></span>引起的突变，如森林砍伐、城市化、洪水和火灾等
			- [[@rodriguezpaulino_2024_ForestDisturbanceCharacterization]] 干扰定义：导致森林组成、结构和功能发生<mark class="highlight">渐变或突变</mark>的离散事件。

---

- 变化检测方法的不足：通常无法检测由于**不同季节**的气候条件（如温度、降水、日照等）导致的地表特征发生周期性变化
<br>
- <strong>变换检测算法的两大挑战</strong>
1. 处理完整的<mark class="highlight">长期</mark>数据中的变化
	- 遥感影像时间序列通常包含季节性、渐进性和突发性变化，以及由几何误差、大气散射和云效应引起的噪声
	- 大多数方法集中在较短时序上（2-5张图像）：
		- 扰动可能在两次影像获取之间发生，可能会将 variability（周期性变换、长期趋势？） 误认为 change（突发变化？） #困惑 
	- 时序分析方法：主成分分析 （PCA）、 小波分解、 傅里叶分析、变化向量分析 （CVA）
		- 思路：根据信号的**时间特征**将噪声与信号区分开来，通过类型变化从多时相的光谱空间中隔离出主导的变化成分
		- 缺点：受限于标记变化成分，因为每次分析完全依赖于所分析的具体图像序列
2. 变化检测方法需要**独立于具体阈值or变换轨迹**
	- 具体阈值：由于不同土地覆盖类型的光谱和物候特征会产生误导性结果
	- 变换轨迹：不依赖于阈值，通过表征变化的时间特征来实现。只有在观测到的光谱轨迹与假设的轨迹之一匹配时才有效。可以理解为是<u>有监督</u>的方法。
	- ➡<mark class="highlight">需要一种无监督、更通用的方法</mark>，独立于阈值和轨迹 ➡**提出BFAST**

---

- 验证方法：
	- 模拟具有不同季节变化量和噪声的归一化植被指数（NDVI）时间序列，并添加不同幅度的突发变化
	- 应用于MODIS 16天合成影像，不依赖于特定的数据类型，也可应用于其他遥感影像时间序列（如Landsat）